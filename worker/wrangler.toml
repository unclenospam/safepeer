name = "safepeer-signaling"
main = "src/index.js"
compatibility_date = "2024-12-01"

# Serve the frontend directory as static assets
# Assets are served automatically; unmatched routes fall through to the Worker
[assets]
directory = "../frontend"

# Durable Objects handle WebRTC signaling per room
# ConnectionLimiter tracks per-IP concurrent room connections
[durable_objects]
bindings = [
    { name = "ROOM", class_name = "Room" },
    { name = "CONNECTION_LIMITER", class_name = "ConnectionLimiter" }
]

[[migrations]]
tag = "v1"
new_classes = ["Room"]

[[migrations]]
tag = "v2"
new_classes = ["ConnectionLimiter"]
